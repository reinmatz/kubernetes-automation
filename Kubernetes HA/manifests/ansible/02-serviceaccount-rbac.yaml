---
# ServiceAccount for Ansible
apiVersion: v1
kind: ServiceAccount
metadata:
  name: ansible-operator
  namespace: ansible
  labels:
    app: ansible

---
# ClusterRole - Ansible permissions
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: ansible-operator
  labels:
    app: ansible
rules:
  # Full access to all resources (f√ºr Cluster-Management)
  - apiGroups: ["*"]
    resources: ["*"]
    verbs: ["*"]

  # Non-resource URLs (health checks, metrics)
  - nonResourceURLs: ["*"]
    verbs: ["get"]

---
# ClusterRoleBinding - Bind ServiceAccount to ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: ansible-operator
  labels:
    app: ansible
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: ansible-operator
subjects:
  - kind: ServiceAccount
    name: ansible-operator
    namespace: ansible
